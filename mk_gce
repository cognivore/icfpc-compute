# Check if first argument is present, if not, exit
if [ -z "$1" ]; then
    echo "Usage: $0 <your_user>"
    exit 1
fi

gcloud compute instances list --filter "status=running" --format "table[no-heading](name,EXTERNAL_IP)" | \
awk "BEGIN {print \"# generated by gciregen\"} {print \"\"; print \"Host \" \$1; print \"HostName \" \$2; print \"User $1\"; print \"IdentityFile ~/.ssh/gce\"; print \"ForwardAgent yes\"}" > "gce.${1}.config"
